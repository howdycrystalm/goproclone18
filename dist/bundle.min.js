angular.module("goApp",["ui.router","ngAnimate","angular-stripe"]).config(["$stateProvider","$urlRouterProvider","stripeProvider",function(e,t,o){o.setPublishableKey("pk_test_Y8LhLNUJyD0m1Zthhv3Q1ijz"),t.otherwise("/"),e.state("home",{templateUrl:"./views/home.html",controller:"homeCtrl",url:"/"}).state("loggin",{templateUrl:"./views/loggin.html",controller:"logginCtrl",url:"/loggin"}).state("cameras",{templateUrl:"./views/cameras.html",controller:"camerasCtrl",url:"/cameras"}).state("drones",{templateUrl:"./views/drones.html",controller:"dronesCtrl",url:"/drones"}).state("apparel",{templateUrl:"./views/apparel.html",controller:"apparelCtrl",url:"/apparel",resolve:{products:["mainService",function(e){return e.getItems().then(function(e){return e})}]}}).state("apparelProduct",{templateUrl:"./views/apparelProduct.html",controller:"apparelProductCtrl",url:"/apparel/:id/:gender"}).state("cart",{templateUrl:"./views/cart.html",controller:"cartCtrl",url:"/cart"}).state("checkout",{templateUrl:"./views/checkout.html",controller:"checkoutCtrl",url:"/checkout"})}]),angular.module("goApp").controller("apparelCtrl",["$scope","mainService","products",function(e,t,o){e.products=o,console.log(o),e.gender="Male",e.productFilter=function(t){return(t[0].gender===e.gender||"NULL"===t[0].gender)&&t},e.sortProducts=function(t){for(var o={},r=0;r<t.length;r++){var n=t[r].id+t[r].gender;o[n]?o[n].push(t[r]):o[n]=[t[r]]}var a=[];for(var i in o)a.push(o[i]);e.products=a},e.sortProducts(e.products)}]),angular.module("goApp").controller("apparelProductCtrl",["$scope","apparelProductService","$stateParams","$timeout",function(e,t,o,r){o.id,o.gender;e.cartId=0,e.prodid=0,e.size=0,e.count=1,e.thumbs=[],e.selected=3,e.showModal=!1,e.selectedIndex=0,e.productImg={},e.getProduct=function(){t.getProduct(o.id,o.gender).then(function(t){e.product=t[0],e.productImg=t[0].img_url})},e.getProduct(),e.imgSwitch=function(t,o){e.selectedImage=t,console.log("I AM MEEEEE!!!",o),e.selectedIndex=o},e.getThumbs=function(){t.getThumbs(o.id,o.gender).then(function(t){e.images=t;for(var o=0;o<t.length;o++)e.thumbs.push(t[o].img_url);e.selectedImage=e.thumbs[0],console.log("this is $scope.thumbs",e.thumbs)})},e.getThumbs(),e.getColorSwatches=function(){t.getColorSwatches(o.id).then(function(t){e.colorSwatches=t,console.log("work with",e.colorSwatches)})},e.getColorSwatches(),e.colorImageSelect=function(t){e.selected=t,0===t||(t=2);for(var o=0;o<e.images.length;o++)if(e.images[o].img_url===e.images[t].img_url)return e.prodid=e.images[t].id,e.cartId=e.images[t].product_id,console.log(e.cartId),console.log(e.images),void(e.selectedImage=e.images[o].img_url)},e.showNext=function(t){var o=e.selectedIndex;console.log(o);var r=e.thumbs;"+"===t&&(o===r.length-1?o=0:o++),"-"===t&&(0===o?o=r.length-1:o--),console.log(r,o),e.selectedImage=r[o],e.selectedIndex=o}}]),angular.module("goApp").service("apparelProductService",["$http",function(e){this.getProduct=function(t){return e({method:"GET",url:"/api/getProduct/"+t}).then(function(e){return e.data})},this.getThumbs=function(t,o){return e({method:"GET",url:"/api/getThumbs/"+t+"/"+o}).then(function(e){return e.data})},this.getColorSwatches=function(t){return e({method:"GET",url:"/api/getColorSwatches/"+t}).then(function(e){return e.data})}}]),angular.module("goApp").controller("camerasCtrl",["$scope",function(e){e.test="Cameras CTRL works",e.currentState="cameras"}]),angular.module("goApp").controller("cartCtrl",["$scope","cartService",function(e,t){e.values=[1,2,3,4,5,6,7,8,9,10]}]),angular.module("goApp").service("cartService",function(){}),angular.module("goApp").controller("checkoutCtrl",["$scope","checkoutService","stripe","$state",function(e,t,o,r){e.stepOneFinished=!1,e.stepTwoFinished=!1,e.stepTwoActive=!1,e.deliveryAddress={},e.billingAddress={},e.payment={},e.clearStepOne=function(t){e.stepOneFinished=!0;for(var o=document.getElementById("delivery_address"),r=document.getElementById("shipping_address"),n=0;n<o.length;n++)e.deliveryAddress[o.elements[n].name]=o.elements[n].value;if(!0===t){for(var n=0;n<o.length;n++)r[n].value=o[n].value;return void e.clearStepTwo()}e.stepTwoActive=!0},e.clearStepTwo=function(){e.stepTwoFinished=!0;for(var t=document.getElementById("shipping_address"),o=0;o<t.length;o++)e.billingAddress[t.elements[o].name]=t.elements[o].value;e.stepTwoActive=!1},e.editOne=function(){e.stepOneFinished=!1,e.stepTwoFinished=!1,e.stepTwoActive=!1},e.editTwo=function(){e.stepOneFinished=!0,e.stepTwoFinished=!1,e.stepTwoActive=!0},e.payment={},e.charge=function(){return o.card.createToken(e.payment.card).then(function(o){var r=angular.copy(e.payment);r.card=void 0,r.token=o.id,t.processPayment(100*e.total,r)}).then(function(t){swal({title:"Thank You!",text:"Your order will be shipped within 3 business days.",imageUrl:"http://www.sv411.com/wp-content/uploads/GoPro-Logo.jpg",confirmButtonText:"Continue exporing GoBro"}),e.zeroOut(),r.go("home")}).catch(function(e){e.type&&/^Stripe/.test(e.type)?console.log("Stripe error: ",e.message):console.log("Other error occurred, possibly with your API",e.message)})}}]),angular.module("goApp").service("checkoutService",["$http",function(e){this.processPayment=function(t,o){return e({method:"POST",url:"/api/payment",data:{amount:t,payment:o}})}}]),angular.module("goApp").controller("dronesCtrl",["$scope",function(e){e.test="drones CTRL works"}]),angular.module("goApp").controller("homeCtrl",["$scope",function(e){e.test="Home CTRL works",e.currentState="home",e.showVid=!1,swal({title:"Welcome to FauxPro",text:"Our team of three cloned GoPro.com to show we can adhere to design comps and implement a live shopping cart. Features include: responsive and mobile-friendly landing and Cameras page, add-to-cart buttons, and checkout functionality. Be warned, it is entirely possible you can give us your money by completing the checkout process, but you ain't gonna be getting any product. It's best not to do it :)",confirmButtonText:"Enjoy!",confirmButtonColor:"#005dac"})}]),angular.module("goApp").service("authService",["$http",function(e){this.login=function(t){return e({method:"POST",url:"/api/login",data:t}).then(function(e){return e})},this.logout=function(){return e({method:"GET",url:"/api/logout"}).then(function(e){return e})},this.getCurrentUser=function(){return e({method:"GET",url:"/api/me"}).then(function(e){return e})},this.registerUser=function(t){return console.log("authService",t),e({method:"POST",url:"/api/register",data:t}).then(function(e){return e})},this.editUser=function(t,o){return e({method:"PUT",url:"/api/user/"+t,data:o}).then(function(e){return e})}}]),angular.module("goApp").service("localStorageServ",["$http",function(e){this.store=function(e,t){return localStorage.setItem(e,JSON.stringify(t)),"saved"},this.get=function(e){var t=localStorage.getItem(e);return JSON.parse(t)}}]),angular.module("goApp").controller("logginCtrl",["$scope","authService","$state",function(e,t,o){e.test="Loggin CTRL works",e.login=function(r){console.log("stephen"),t.login(r).then(function(t){t.data?(e.iLogedIn(t.data.first_name),o.go("home")):(alert("User does not exist"),e.user.password="")}).catch(function(e){alert("Unable to login")})},e.register=function(o){t.registerUser(o).then(function(t){console.log("loginCtrl",o),t.data?(alert("User Created"),e.newUser={}):alert("Unable to create user1")}).catch(function(e){alert("Unable to create user2")})}}]),angular.module("goApp").service("userService",["$http",function(e){this.getUsers=function(){return e({method:"GET",url:"/user"}).then(function(e){return e})},this.getUser=function(t){return e({method:"GET",url:"/user?_id="+t}).then(function(e){return e})}}]),angular.module("goApp").directive("banner",function(){return{restrict:"E",templateUrl:"./views/bannerDir.html",scope:{state:"=",products:"=",subtot:"=",incart:"=",islogged:"=",displayname:"="},controller:["$scope",function(e){e.hoverShop=!1,e.hoverWatch=!1,e.cartShow=!1}]}}),angular.module("goApp").directive("footer",function(){return{restrict:"E",templateUrl:"./views/footerDir.html",scope:{item:"="},controller:["$scope",function(e){}]}}),angular.module("goApp").controller("mainCtrl",["$scope","$state","$timeout","$rootScope","mainService",function(e,t,o,r,n){e.stateName,e.cart=[],e.subTotal=0,e.items=0,e.shipping=18,e.total=18,e.login=!1,e.name="rasbandit",e.iLogedIn=function(t){console.log(e.login),e.login=!0,console.log(e.login),e.name=t},e.zeroOut=function(){e.cart=[],e.subTotal=0,e.items=0,e.total=0},e.addToCart=function(t,o,r,a){console.log(r),n.getItem(t,o,r,a).then(function(t){e.cart=n.checkDouble(e.cart,t),console.log(e.cart),e.subTotal=n.getSubTotal(e.cart),e.items=n.getNumOfItems(e.cart),e.total=parseInt(e.shipping)+parseInt(e.subTotal)})},e.removeFromCart=function(t){e.cart=n.removeItem(e.cart,t),e.subTotal=n.getSubTotal(e.cart),e.items=n.getNumOfItems(e.cart),e.total=parseInt(e.shipping)+parseInt(e.subTotal)},e.updateTotal=function(){e.subTotal=n.getSubTotal(e.cart),e.items=n.getNumOfItems(e.cart),e.total=parseInt(e.shipping)+parseInt(e.subTotal)},r.$on("$stateChangeStart",function(r,n,a,i,l){o(function(){e.stateName=t.current.name},100)})}]),angular.module("goApp").service("mainService",["$http",function(e){this.getItem=function(t,o,r,n){return e({method:"GET",url:"/api/getItem/"+t+"/"+o}).then(function(e){return e.data[0].count=r,"null"!==n&&(e.data[0].size=n),e.data[0]})},this.checkDouble=function(e,t){for(var o=0;o<e.length;o++)if(e[o].id===t.id&&e[o].size===t.size)return e[o].count+=t.count,e;return e.push(t),e},this.getSubTotal=function(e){for(var t=0,o=0;o<e.length;o++)t+=parseFloat(e[o].count)*parseFloat(e[o].price);return t},this.getNumOfItems=function(e){for(var t=0,o=0;o<e.length;o++)t+=parseInt(e[o].count);return t},this.removeItem=function(e,t){for(var o=0;o<e.length;o++)if(e[o].id===t)return e.splice(o,1),e},this.getItems=function(){return e({method:"GET",url:"/api/getItems"}).then(function(e){return e.data})}}]);